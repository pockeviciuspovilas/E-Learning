@model List<Elearn.Models.Asign>

@{
    Layout = "~/Views/Report/Shared/_Layout.cshtml";
    ViewData["Title"] = "My tests";
    int completedTests = 0;
    int pendingTests = 0;
    double markSum = 0;
    
}
<h2>@ViewBag.User user report</h2>
<table class="table table-hover">
  <thead>
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Test name</th>
      <th scope="col">Mark</th>
    </tr>
  </thead>
  <tbody>
@for(int i=0;i < Model.Count; i++)
{
    string Mark = Model[i].Result.SingleOrDefault() != null ?
    Model[i].Result.SingleOrDefault().Mark.ToString() : "-1" ;

    if(int.Parse(Mark)>=0)
    {
        completedTests++;
        markSum+= int.Parse(Mark);
    }
       
    if(int.Parse(Mark)==-2)
        pendingTests++;
    string Date = Model[i].Result.SingleOrDefault() != null && Model[i].Result.SingleOrDefault().CompleteTime!= null ?
      Model[i].Result.SingleOrDefault().CompleteTime.ToString() : "NesprÄ™sta" ;
    if(Date == "1/1/2000 12:00:00 AM")
      Date = "Unsolved";
    string MarkPercent = Mark + "%";
    @:
    <tr>
    <th scope="row">@Date</th>
    <td>@Model[i].Test.Name</td>
    <td>
        @if (Mark == "-2")
        {
            <text>Waiting for result</text>
        }
        else if (Mark == "-1")
        {
            <text>Test not solved</text>
        }
        else
        {
            <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="@Mark" aria-valuemin="0" aria-valuemax="100" style="width: @MarkPercent"><strong>@MarkPercent</strong></div>
            </div>
        }

    </td>
    </tr>

} 
  </tbody>
</table>
<br/>
<br/>
  <div class="row">
    <div class="col">
        <text> User assigned tests: <strong> @Model.Count</strong></text><br/>
        <text> User solved tests: <strong> @completedTests</strong></text><br/>
        <text> Waiting for result: <strong> @pendingTests</strong></text><br/>
    </div>
    <div class="col">
        <h3>User average mark: @(markSum/completedTests)</h3>
    </div>
  </div>
